# –ü—Ä–æ–µ–∫—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–∞ —Å –≤–æ–¥–æ–π
![sc](https://badgen.net/github/release/ErilovNikita/water-barell-hass)

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è —É—Ä–æ–≤–Ω—è –≤–æ–¥—ã –≤ –±–æ—á–∫–µ, –∞ —Ç–∞–∫ –∂–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –µ–µ –±–µ–∑ —É—á–∞—Å—Ç–∏—è —á–µ–ª–æ–≤–µ–∫–∞.

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å](#–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è-—á–∞—Å—Ç—å)
    - [–ú–∞—Ç–µ—Ä–∏–∞–ª—ã](#–ú–∞—Ç–µ—Ä–∏–∞–ª—ã)
    - [–°–±–æ—Ä–∫–∞](#–°–±–æ—Ä–∫–∞)
- [–ü—Ä–æ–≥—Ä–∞–º–º–∞—è —á–∞—Å—Ç—å](#–ü—Ä–æ–≥—Ä–∞–º–º–∞—è-—á–∞—Å—Ç—å)
    - [–§—É–Ω–∫—Ü–∏–∏–æ–Ω–∞–ª](#–§—É–Ω–∫—Ü–∏–∏–æ–Ω–∞–ª)
    - [–ü—Ä–æ—à–∏–≤–∫–∞](#–ü—Ä–æ—à–∏–≤–∫–∞)
    - [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Home Assistant](#–ù–∞—Å—Ç—Ä–æ–π–∫–∞-Home-Assistant)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã](#–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-—Å–∫—Ä–∏–Ω—à–æ—Ç—ã)

## –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å
### –ú–∞—Ç–µ—Ä–∏–∞–ª—ã
- –ú–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä NodeMCU v3 x 1
- –£–ª—å—Ç–∞–∑–≤—É–∫–æ–≤–æ–π –¥–∞–ª—å–Ω–æ–º–µ—Ä HC-SR04 x 1
- 4-—Ö –ø–∏–Ω–æ–≤—ã–µ —Ä–∞–∑—å–µ–º—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ x 2
- –ó–∞–∂–∏–º –±–æ–ª—Ç–æ–≤–æ–π 2 –ø–∏–Ω —Ö 1
- –°–≤–µ—Ç–æ–¥–∏–æ–¥ –∑–µ–ª–µ–Ω—ã–π —Ö 1
- –†–µ–∑–∏—Å—Ç–æ—Ä 1–∫–û–º —Ö 1
- –†–µ–∑–∏—Å—Ç–æ—Ä 2–∫–û–º —Ö 1
- –†–µ–∑–∏—Å—Ç–æ—Ä 10–∫–û–º —Ö 1
- –¢—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä 2n2222 x 1
- –î–∏–æ–¥ LL4148 x 1
- –†–æ—Å—Å—ã–ø—å –ø—Ä–æ–≤–æ–¥–æ–≤

### –°–±–æ—Ä–∫–∞ 
–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è NodeMCU
![–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è NodeMCU ](/scheme/scheme3.png "–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è")

–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ESP-01
![–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ESP-01 ](/scheme/scheme2.png "–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è")

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —è –Ω–∞—Ä–∏—Å–æ–≤–∞–ª –≤—Å—é —Å—Ö–µ–º—É –ø–æ –ø–æ–∫–ª—é—á–µ–Ω–∏—é –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª –ø–µ—á–∞—Ç–Ω—É—é –ø–ª–∞—Ç—É –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω–æ–º —Å–∞–π—Ç–µ
–î–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–π —Å–±–æ—Ä–∫–∏ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è grabber —Ñ–∞–π–ª–æ–º –∏–∑ –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ ESP-01 üëâ [Gerber_water-barrel-hass.zip](/scheme/Gerber_water-barrel-hass.zip)

–ï—Å–ª–∏ –≤—ã –±—É–¥–µ—Ç–µ –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å –ø–ª–∞—Ç—É –Ω–∞ –±–∞–∑–µ ESP-01 –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —á—Ç–æ-—Ç–æ –Ω–∞–ø–æ–¥–æ–±–∏–∏ —ç—Ç–æ–≥–æ
![–ì–æ—Ç–æ–≤–∞—è –ø–ª–∞—Ç–∞ ESP-01](/scheme/scheme1.png "–ì–æ—Ç–æ–≤–∞—è –ø–ª–∞—Ç–∞")


## –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —á–∞—Å—Ç—å

### –§—É–Ω–∫—Ü–∏–∏–æ–Ω–∞–ª
- –ï—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –≤–æ–¥—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞–º–∏
- –ö–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ —É—Ä–æ–≤–Ω–µ–º –≤–æ–¥—ã
- –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è lovelace

### –ü—Ä–æ—à–∏–≤–∫–∞
–ü—Ä–æ–≥—Ä–∞–º–º–∞–Ω–∞—è —á–∞—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∏—Ç—å—Å—è –Ω–∞ –±–∞–∑–µ –ø—Ä–æ—à–∏–≤–∫–∏ [ESPHome](https://esphome.io)

–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ—à–∏–≤–∫–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç—É—Ç üëâ [water-barrel.yaml](/esphome/water-barrel.yaml)

–î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –≤ ESPHome –∏ –ø—Ä–æ—à–∏–≤–∞–µ–º –Ω–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Home Assistant
–ù–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å package —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è–º–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–±—å–µ–∫—Ç–∞–º–∏ 
1. –°–∫–∞—á–∏–≤–∞–µ–º –ø–∞–∫–µ—Ç [water-barrel-package.yaml](/homeassistant/water-barrel-package.yaml)
1. –î–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ –ø–∞–ø–∫—É */config/packages/*
1. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –∫–æ–¥–µ –Ω–∞ —Å–≤–æ–∏, –¥–ª—è —ç—Ç–æ–≥–æ —Å–º–æ—Ç—Ä–∏–º —Ç–∞–±–ª–∏—Ü—É –Ω–∏–∂–µ 

    | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤ –∫–æ–¥–µ        | –û–ø–∏—Å–∞–Ω–∏–µ            |
    |--------------------------|---------------------|
    | switch.nasosy            | –í—ã–∫–ª—é—á–∞—Ç–µ–ª—å –Ω–∞—Å–æ—Å–æ–≤ **(–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω–µ—à–Ω–µ–µ —Ä–µ–ª–µ. –í —Å–ª—É—á–∞–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ö–µ–º—ã –Ω–∞ nodeMCU –º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!)** |
    | sensor.ultrasonic_sensor | –£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –¥–∞–ª—å–Ω–æ–º–µ—Ä, –∏–º—è –æ–±—å–µ–∫—Ç–∞ –∏–∑ –ø—Ä–æ—à–∏–≤–∫–∏ esp |


–î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∏—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ –æ–±—å–µ–∫—Ç—ã –Ω–∞ lovelace, –ø—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —á—É—Ç—å –Ω–∏–∂–µ

![](/screenshots/screen1.png)
``` yaml
type: vertical-stack
cards:
  - type: gauge
    entity: sensor.template_barrel_water_level
    name: –£—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã
    needle: true
    severity:
      green: 80
      yellow: 20
      red: 0
  - type: entities
    entities:
      - entity: sensor.template_barrel
      - entity: switch.nasosy
      - entity: sensor.template_barrel_water_level
      - entity: input_number.barrel_max_level
      - entity: input_number.barrel_min_level
      - entity: input_boolean.barrel_auto_level
  - hours_to_show: 24
    graph: line
    type: sensor
    entity: sensor.template_barrel_water_level
    detail: 1
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
![](/screenshots/screen3.png)
